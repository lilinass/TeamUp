<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="icon" type="image/png" href="./Images/Logo v2.png" />
    <title>Koordy â€“ Association</title>
    <meta name="description" content="Page dâ€™accueil dâ€™une association sportive sur Koordy." />
    <link rel="stylesheet" href="style.css" />
    <script src="association.js"></script>

</head>

<body>
    <!-- Topbar -->
    <div class="topbar" role="region" aria-label="Infos rapides">
        <div class="container topbar__inner">
            <p class="topbar__note">
                Prochain entraÃ®nement : <strong>Mercredi 19h</strong> â€“ Salle omnisports.
            </p>
            <nav class="topbar__links" aria-label="Liens utilitaires">
                <a href="#" class="link">Billetterie</a>
                <a href="#" class="link">Boutique</a>
                <a href="#" class="link">FR</a>
            </nav>
        </div>
    </div>

    <!-- Header -->
    <header class="site-header" role="banner">
        <div class="container site-header__inner">
            <!-- Logo / marque -->
            <a href="/" class="brand">
                <img src="./Images/Logo v2.png" alt="Koordy" class="brand__logo" />
                <span class="brand__name">Koordy</span>
            </a>

            <!-- Navigation principale de lâ€™asso -->
            <nav class="nav" aria-label="Navigation principale">
                <ul class="nav__list">
                    <li>
                        <a class="nav__link is-active" href="#hero">Accueil</a>
                    </li>
                    <li>
                        <a class="nav__link" href="#about">Association</a>
                    </li>
                    <li>
                        <a class="nav__link" href="#teams">Ã‰quipes / ActivitÃ©s</a>
                    </li>
                    <li>
                        <a class="nav__link" href="#events">Ã‰vÃ¨nement</a>
                    </li>
                    <li>
                        <a class="nav__link" href="#actus">ActualitÃ©s</a>
                    </li>
                    <li>
                        <a class="nav__link" href="#contact">Contact</a>
                    </li>
                </ul>
            </nav>

            <!-- Boutons auth -->
            <div id="user-badge" class="auth-buttons"></div>

        </div>
    </header>

    <main>
        <!-- HERO ASSOCIATION -->
        <section id="hero" class="hero hero--asso" role="region" aria-label="PrÃ©sentation de lâ€™association">
            <!-- image de fond spÃ©cifique Ã  lâ€™asso -->
            <div id="asso-cover" class="hero__bg hero__bg--asso" aria-hidden="true"
                style="background-image: url('./Images/image.png')"></div>

            <div class="container hero__content hero__content--asso">
                <div class="hero__top">
                    <!-- bloc identitÃ© avec image de profil -->
                    <div class="hero__identity">
                        <div class="hero__avatar">
                            <img id="asso-avatar" src="./Images/default-asso.png" alt="Logo de l'association" />
                        </div>

                        <div class="hero__identity-text">
                            <div class="hero__eyebrow">Association</div>
                            <h1 id="asso-name" class="hero__title hero__title--asso">
                                Handball Club Koordy
                            </h1>
                            <p id="asso-subtitle" class="hero__desc hero__desc--small">
                                Nantes Â· Handball
                            </p>
                        </div>
                    </div>

                    <!-- stats + boutons -->
                    <div class="hero__side">
                        <div class="hero__meta">
                            <div class="hero-stat">
                                <span id="stat-membres" class="hero-stat__value">150</span>
                                <span class="hero-stat__label">LicenciÃ©s</span>
                            </div>
                            <div class="hero-stat">
                                <span id="stat-equipes" class="hero-stat__value">8</span>
                                <span class="hero-stat__label">Ã‰quipes</span>
                            </div>
                            <div class="hero-stat">
                                <span id="stat-events" class="hero-stat__value">3</span>
                                <span class="hero-stat__label">Ã‰vÃ©nements ce mois-ci</span>
                            </div>
                        </div>

                        <div class="hero__actions">
                            <a href="/connexion" class="btn btn--primary">
                                Rejoindre lâ€™association
                            </a>
                            <a href="#contact" class="btn btn--ghost">
                                Nous contacter
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </section>


        <!-- QUI SOMMES-NOUS ? -->
        <section id="about" class="section">
            <div class="container">
                <h2 class="section__title section__title--line">Ã€ PROPOS DU CLUB</h2>
                <p id="asso-description">
                    <!-- rempli par JS -->
                </p>
            </div>
        </section>

        <!-- Ã‰QUIPES / ACTIVITÃ‰S (simple teaser pour lâ€™instant) -->
        <section id="teams" class="section section--asso-teams" aria-labelledby="teams-title">
            <div class="container">
                <h2 id="teams-title" class="section__title section__title--line">
                    NOS Ã‰QUIPES & ACTIVITÃ‰S
                </h2>

                <div class="cards cards--news">
                    <article class="card">
                        <div class="card__body">
                            <h3 class="card__title">Ã‰cole de hand</h3>
                            <p class="card__meta">U9 Â· U11</p>
                            <p class="card__text">
                                DÃ©couverte du handball Ã  travers le jeu, dans une
                                ambiance ludique et encadrÃ©e.
                            </p>
                        </div>
                    </article>

                    <article class="card">
                        <div class="card__body">
                            <h3 class="card__title">Collectifs jeunes</h3>
                            <p class="card__meta">U13 Ã  U18</p>
                            <p class="card__text">
                                EntraÃ®nements rÃ©guliers, compÃ©titions de championnat
                                et tournois rÃ©gionaux.
                            </p>
                        </div>
                    </article>

                    <article class="card">
                        <div class="card__body">
                            <h3 class="card__title">Section loisirs</h3>
                            <p class="card__meta">Adultes</p>
                            <p class="card__text">
                                Pratique sans pression du rÃ©sultat, pour garder la
                                forme et partager un bon moment chaque semaine.
                            </p>
                        </div>
                    </article>
                </div>
            </div>
        </section>

        <!-- CONSEIL DU CLUB -->
        <section id="conseil" class="section section--asso-conseil" aria-labelledby="conseil-title">
            <div class="container">
                <h2 id="conseil-title" class="section__title section__title--line">
                    LE CONSEIL DU CLUB
                </h2>
                <div id="conseil-grid" class="conseil-grid"></div>

                <div id="conseil-empty" style="display:none;">
                    Aucun membre du conseil pour le moment.
                </div>

            </div>
        </section>

        <!-- CALENDRIER DES Ã‰VÃ‰NEMENTS -->
        <section id="events" class="section section--asso-events" aria-labelledby="events-title">
            <!-- Titre + actions -->
            <div class="container section__head">
                <h2 id="events-title" class="section__title section__title--line">
                    CALENDRIER DES Ã‰VÃ‰NEMENTS
                </h2>

                <div class="events-head-actions">
                    <!-- Filtre mois (pour plus tard, JS) -->
                    <select id="events-month-filter" class="events-filter">
                        <option value="all">Tous les mois</option>
                        <option value="01">Janvier</option>
                        <option value="02">FÃ©vrier</option>
                        <option value="03">Mars</option>
                        <option value="04">Avril</option>
                        <option value="05">Mai</option>
                        <option value="06">Juin</option>
                        <option value="07">Juillet</option>
                        <option value="08">AoÃ»t</option>
                        <option value="09">Septembre</option>
                        <option value="10">Octobre</option>
                        <option value="11">Novembre</option>
                        <option value="12">DÃ©cembre</option>
                    </select>

                    <!-- Bouton visible plus tard uniquement pour les admins via JS -->
                    <button id="btn-add-event" class="btn btn--primary btn--sm btn--admin-only" type="button">
                        Ajouter un Ã©vÃ©nement
                    </button>
                </div>
            </div>

            <!-- Layout calendrier / liste dâ€™Ã©vÃ©nements -->
            <div class="container events-layout">
                <!-- Colonne gauche : petit rÃ©sumÃ© / lÃ©gende -->
                <aside class="events-side">
                    <p class="events-side__title">Vue rapide</p>
                    <p class="events-side__text">
                        Consultez les prochains matchs, entraÃ®nements, rÃ©unions
                        et Ã©vÃ©nements du club. Les membres conviÃ©s recevront une notification
                    </p>

                    <ul class="events-legend">
                        <li><span class="events-dot events-dot--match"></span> Match</li>
                        <li><span class="events-dot events-dot--training"></span> EntraÃ®nement</li>
                        <li><span class="events-dot events-dot--meeting"></span> RÃ©union</li>
                        <li><span class="events-dot events-dot--other"></span> Autre</li>
                    </ul>
                </aside>

                <!-- Colonne droite : â€œcalendrier dâ€™Ã©vÃ©nementsâ€ sous forme de liste -->
                <div class="events-main">
                    <p id="events-empty" class="events-empty">
                        Aucun Ã©vÃ©nement Ã  venir pour le moment.
                    </p>

                    <div id="events-list" class="events-list">

                    </div>
                </div>
            </div>
        </section>


        <!-- DERNIÃˆRES ACTUALITÃ‰S -->
        <section id="actus" class="section" aria-labelledby="news-title">
            <div class="container section__head">
                <h2 id="news-title" class="section__title">
                    DERNIÃˆRES ACTUALITÃ‰S
                </h2>

                <a href="#" class="section__cta">
                    Voir toutes les actus du club
                </a>
            </div>

            <div class="container">
                <p id="news-empty" class="events-empty">
                    Aucune actualitÃ© pour le moment.
                </p>

                <div id="news-list" class="cards cards--news">
                    <!-- Cartes dâ€™actualitÃ©s gÃ©nÃ©rÃ©es en JS -->
                </div>
            </div>
        </section>


        <!-- CONTACT / INFOS PRATIQUES -->
        <section id="contact" class="section section--asso-contact" aria-labelledby="contact-title">
            <div class="container contact-grid">
                <div>
                    <h2 id="contact-title" class="section__title section__title--line">
                        INFOS PRATIQUES
                    </h2>

                    <p><strong>Adresse :</strong> <span id="asso-adresse">â€”</span></p>
                    <p><strong>Ville :</strong> <span id="asso-ville">â€”</span></p>
                    <p><strong>Pays :</strong> <span id="asso-pays">â€”</span></p>
                </div>

                <div>
                    <h2 class="section__title section__title--line">CONTACT</h2>

                    <p>
                        <strong>Email :</strong>
                        <a id="asso-email" href="#">â€”</a>
                    </p>

                    <p>
                        <strong>TÃ©lÃ©phone :</strong>
                        <span id="asso-telephone">â€”</span>
                    </p>

                    <div class="asso-socials" id="asso-socials"></div>
                </div>
            </div>
        </section>


    </main>

    <div id="event-modal" class="modal" style="display:none;">
        <div class="modal__overlay" id="event-modal-close"></div>

        <div class="modal__content">
            <h3>Ajouter un Ã©vÃ©nement</h3>

            <form id="event-form" class="modal__form">
                <input id="ev-title" placeholder="Titre*" required />

                <select id="ev-type" required>
                    <option value="">Type*</option>
                    <option value="MATCH">Match</option>
                    <option value="ENTRAINEMENT">EntraÃ®nement</option>
                    <option value="REUNION">RÃ©union</option>
                    <option value="AUTRE">Autre</option>
                </select>

                <input id="ev-lieu" placeholder="Lieu" />
                <textarea id="ev-desc" placeholder="Description"></textarea>

                <label>Date dÃ©but*</label>
                <input id="ev-start" type="datetime-local" required />

                <label>Date fin</label>
                <input id="ev-end" type="datetime-local" />

                <button type="submit" class="btn btn--primary">CrÃ©er</button>
            </form>
        </div>
    </div>
    <style>
        /* ===============================
   MODAL â€” AJOUT EVENEMENT
================================ */

        .modal {
            position: fixed;
            inset: 0;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Fond sombre */
        .modal__overlay {
            position: absolute;
            inset: 0;
            background: rgba(5, 6, 10, 0.75);
            backdrop-filter: blur(4px);
        }

        /* Contenu */
        .modal__content {
            position: relative;
            z-index: 1;
            width: min(520px, 92vw);
            background: #111319;
            border-radius: 18px;
            border: 1px solid #232736;
            box-shadow: 0 18px 40px rgba(0, 0, 0, 0.6);
            padding: 26px 24px 28px;
            color: #e6e7eb;
            animation: modalIn 0.25s ease-out;
        }

        /* Animation dâ€™apparition */
        @keyframes modalIn {
            from {
                opacity: 0;
                transform: translateY(8px) scale(0.98);
            }

            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        /* Titre */
        .modal__content h3 {
            margin: 0 0 18px;
            text-align: center;
            font-size: 1.35rem;
            font-weight: 700;
            letter-spacing: 0.3px;
        }

        /* ===============================
   FORMULAIRE
================================ */

        .modal__form {
            display: grid;
            gap: 14px;
        }

        .modal__form label {
            font-size: 0.85rem;
            color: #9aa3b2;
            margin-top: 4px;
        }

        /* Champs */
        .modal__form input,
        .modal__form select,
        .modal__form textarea {
            width: 100%;
            background: #171a21;
            color: #e6e7eb;
            border: 1px solid #2b3346;
            border-radius: 12px;
            padding: 12px;
            font-size: 0.95rem;
            font-family: inherit;
        }

        /* Textarea */
        .modal__form textarea {
            resize: vertical;
            min-height: 90px;
        }

        /* Focus */
        .modal__form input:focus,
        .modal__form select:focus,
        .modal__form textarea:focus {
            outline: none;
            border-color: #6cf;
            box-shadow: 0 0 0 3px rgba(102, 204, 255, 0.25);
        }

        /* Bouton */
        .modal__form button {
            margin-top: 10px;
            padding: 14px;
            border-radius: 999px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
        }

        .btn--admin-only {
            display: none;
        }

        /*------------css badge actualite------------*/
        .news-badge {
            display: inline-block;
            margin-right: 8px;
            padding: 3px 8px;
            border-radius: 999px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .news-badge--event {
            background: #ffe8cc;
            color: #b45309;
        }

        .news-badge--article {
            background: #e0f2fe;
            color: #0369a1;
        }

        /* ===============================
   RESPONSIVE
================================ */

        @media (max-width: 480px) {
            .modal__content {
                padding: 22px 18px 24px;
            }
        }
    </style>
<script>
/* ============================================================
   ðŸ”µ 1) Charger les informations de l'association du membre
   ============================================================ */
async function loadAssociation() {
  const id_membre = localStorage.getItem("id_membre");

  if (!id_membre) {
    console.warn("Aucun membre connectÃ©.");
    return;
  }

  const res = await fetch(`http://localhost:8080/api/membre/${id_membre}/association`);
  const asso = await res.json();

  console.log("Association chargÃ©e :", asso);

  if (!asso || !asso.id_association) {
    console.warn("Aucune association trouvÃ©e pour ce membre.");
    return;
  }

  // Nom de l'association (H1 du hero)
  if (asso.nom) {
    document.getElementById("asso-name").textContent = asso.nom;
  }

  // Sous-titre ville + sport
  const subtitle = `${asso.ville || ""} Â· ${asso.sport || ""}`.trim();
  document.getElementById("asso-subtitle").textContent = subtitle;

  // Logo / avatar
  if (asso.image) {
    document.getElementById("asso-avatar").src = asso.image;
  }

  // Image de couverture
  if (asso.image) {
    document.getElementById("asso-cover").style.backgroundImage = `url('${asso.image}')`;
  }

  // Couleurs personnalisÃ©es
  if (asso.couleur_1 && asso.couleur_2) {
    document.documentElement.style.setProperty("--brand", asso.couleur_1);
    document.documentElement.style.setProperty("--brand-2", asso.couleur_2);
  }
}



/* ============================================================
   ðŸ”µ 2) Charger l'utilisateur connectÃ© et afficher le menu â–¼
   ============================================================ */
async function loadUser() {
  const id_membre = localStorage.getItem("id_membre");
  const badge = document.getElementById("user-badge");

  // ðŸŸ¥ Utilisateur non connectÃ© â†’ montrer "Se connecter / Sâ€™inscrire"
  if (!id_membre) {
    badge.innerHTML = `
      <a href="/connexion" class="btn btn--ghost btn--sm">Se connecter</a>
      <a href="/inscription" class="btn btn--primary btn--sm">Sâ€™inscrire</a>
    `;
    return;
  }

  // Charger les infos depuis la BDD
  const res = await fetch(`http://localhost:8080/api/membre/${id_membre}`);
  const user = await res.json();

  // ðŸŸ¦ Injecter le menu dÃ©roulant dans le header
  badge.innerHTML = `
  <div class="user-dropdown">
    <button id="userDropdownBtn" class="user-dropdown-btn">
      Bienvenue, ${user.prenom_membre} â–¼
    </button>

    <div id="userDropdownMenu" class="user-dropdown-menu">
      <a href="/membre">Mon profil</a>
      <a href="/events_page">Mes Ã©vÃ¨nements</a>
      <button id="logoutBtn">Se dÃ©connecter</button>
    </div>
  </div>
`;
  const btn = document.getElementById("userDropdownBtn");
  const menu = document.getElementById("userDropdownMenu");

  // Ouvrir / fermer le menu â–¼
  btn.addEventListener("click", () => {
    menu.style.display = menu.style.display === "flex" ? "none" : "flex";
  });

  // DÃ©connexion
  document.getElementById("logoutBtn").addEventListener("click", () => {
    localStorage.removeItem("id_membre");
    window.location.href = "/";
  });

  // Fermer le menu quand on clique ailleurs
  document.addEventListener("click", (e) => {
    if (!badge.contains(e.target)) {
      menu.style.display = "none";
    }
  });
}



/* ============================================================
   ðŸš€ 3) Lancer les deux fonctions au chargement de la page
   ============================================================ */
loadAssociation();
loadUser();
</script>




</body>

</html>